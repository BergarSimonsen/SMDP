<html>
	<head>
		<link rel="stylesheet" href="jqwidgets-ver3.8.0/jqwidgets/styles/jqx.base.css" type="text/css"/>
		<script type="text/javascript" src="jqwidgets-ver3.8.0/scripts/jquery-1.11.1.min.js"></script>
		<script type="text/javascript" src="jqwidgets-ver3.8.0/jqwidgets/jqxcore.js"></script>
		<script type="text/javascript" src="jqwidgets-ver3.8.0/jqwidgets/jqxbuttons.js"></script>
		<script type="text/javascript" src="jqwidgets-ver3.8.0/jqwidgets/jqxscrollbar.js"></script>
		<script type="text/javascript" src="jqwidgets-ver3.8.0/jqwidgets/jqxlistbox.js"></script>
		<script type="text/javascript" src="jqwidgets-ver3.8.0/jqwidgets/jqxcombobox.js"></script>
		<script type='text/javascript'>
			$(document).ready(function(){
				
		
		var $ColorValues = [
		"RED" ,
						"BLACK" ,
						"BLUE" 
						];
		$("#Color").jqxComboBox({ source: $ColorValues, width: '200px', height: '25px',});
		
		var $SizeValues = [
		1 ,
						2 ,
						3 ,
						4 ,
						5 
						];
		$("#Size").jqxComboBox({ source: $SizeValues, width: '200px', height: '25px',});
		
		
		var $PrintColorValues = [
		"RED" ,
						"BLACK" ,
						"BLUE" 
						];
		$("#PrintColor").jqxComboBox({ source: $PrintColorValues, width: '200px', height: '25px',});
		
		var $PrintShapeValues = [
		"ROUND" ,
						"SQUARE" ,
						"TRIANGULAR" 
						];
		$("#PrintShape").jqxComboBox({ source: $PrintShapeValues, width: '200px', height: '25px',});
		
		var $PrintPlacementValues = [
		"Front" ,
						"Back" ,
						"LeftSleeve" ,
						"RightSleeve" 
						];
		$("#PrintPlacement").jqxListBox({ source: $PrintPlacementValues, width: '200px', height: '150px', multiple: true});
		
				
				function checkConstraints() { 
					var valid = "";
					
						if($("#Name").val() === "") valid += "Name must be filled! \n";
						
						if($("#Color").jqxComboBox('getSelectedItem') === null) valid += "Color must be selected! \n";
						
						if($("#Size").jqxComboBox('getSelectedItem') === null) valid += "Size must be selected! \n";
						
						
						if($("#PrintColor").jqxComboBox('getSelectedItem') === null) valid += "PrintColor must be selected! \n";
						
						if($("#PrintShape").jqxComboBox('getSelectedItem') === null) valid += "PrintShape must be selected! \n";
						
						var itemsPrintPlacement = $("#PrintPlacement").jqxListBox('getSelectedItems');
						if(itemsPrintPlacement.length == 0) valid += "PrintPlacement must be selected! \n";
						
						
						if(valid === "") {
							if(!((($("#Color").jqxComboBox('getSelectedItem').value != "RED") || (($("#Color").jqxComboBox('getSelectedItem').value === "RED")
							 && ($("#Size").jqxComboBox('getSelectedItem').value > 3))))) 
								valid += "Invalid constraint: " + "((Color != String.RED) || ((Color === String.RED) && (Size > 3))) \n";
							if(!(( 	$("#Color").jqxComboBox('getSelectedItem').value != $("#PrintColor").jqxComboBox('getSelectedItem').value))) 
								valid += "Invalid constraint: " + "(Color != PrintColor) \n";
						}
						 
					return valid;
				};
				
				function getText() {
					var text = "";
		text += "Name: " + $("#Name").val() + " \r\n";
		
		text += "Color: " + $("#Color").jqxComboBox('getSelectedItem').value + " \r\n";
		
		text += "Size: " + $("#Size").jqxComboBox('getSelectedItem').value + " \r\n";
		
		text += "Print: " + "\r\n";
		
		text += "PrintColor: " + $("#PrintColor").jqxComboBox('getSelectedItem').value + " \r\n";
		
		text += "PrintShape: " + $("#PrintShape").jqxComboBox('getSelectedItem').value + " \r\n";
		
		var itemsPrintPlacement = $("#PrintPlacement").jqxListBox('getSelectedItems');
		text += "PrintPlacement: ";		
		jQuery.each(itemsPrintPlacement, function(index, value){
			text += this.value + ", "
		});
		text += " \r\n";
		
					return text;
				};				
				
				$('#submitButton').click(function(){
					var validationMsg = checkConstraints();
		
					if(validationMsg.length === 0)
						save();
					else
						alert(validationMsg + "\n Please correct the values!");
				});
			
				function save() {
					var textToWrite = getText();
					var textFileAsBlob = new Blob([textToWrite], {type:'text/plain'});
					var fileNameToSaveAs = "config.txt";
		
					var downloadLink = document.createElement("a");
					downloadLink.download = fileNameToSaveAs;
					downloadLink.innerHTML = "Download File";
					if (window.webkitURL != null) {			
						downloadLink.href = window.webkitURL.createObjectURL(textFileAsBlob);
					}
					else
					{
						downloadLink.href = window.URL.createObjectURL(textFileAsBlob);
						downloadLink.onclick = destroyClickedElement;
						downloadLink.style.display = "none";
						document.body.appendChild(downloadLink);
					}
		
					downloadLink.click();
				}
			
				function destroyClickedElement(event){
					document.body.removeChild(event.target);
				}	
			});
		</script>
  			</head>
  			<body>
  				<h2> ShirtConfigurator </h2>
   				<hr/>
   				
  				<h3>Name:</h3>
  				<form>
  				<input type='text' name='Name' id='Name'/>
  				</form>
  				
  				<h3>Color:</h3>
  				<div id='Color' class='combobox'>
  				</div>
  				
  				<h3>Size:</h3>
  				<div id='Size' class='combobox'>
  				</div>
  				
  				<h3>Print:</h3>
  				
  				<h4>PrintColor:</h4>
  				<div id='PrintColor' class='combobox'>
  				</div>
  				
  				<h4>PrintShape:</h4>
  				<div id='PrintShape' class='combobox'>
  				</div>
  				
  				<h4>PrintPlacement:</h4>
  				<div id='PrintPlacement' class='listbox'>
  				</div>
  				
  				
  				<br/><br/>
		<button type="button" id='submitButton'>Submit</button>
  			</body>
</html>
